#!/usr/bin/env python

from __future__ import print_function
from sys import argv, stdin

hexlen = 16
rowlen = 56
trstring = '.'*32 + ''.join([chr(i) for i in range(32, 127)]) + '.'*129

def hexcat(string):
    output = ' '*9
    output += ' '.join('{:02x}'.format(i) for i in range(hexlen)) + '\n'
    output += '='*rowlen + '\n'
    for rowstart in range(0, len(string), hexlen):
        output += "{:04x}0 >> ".format(rowstart)
        line = string[rowstart:rowstart + hexlen]
        output += ' '.join("{:02x}".format(ord(c)) for c in line)
        output += ' ' * (hexlen - len(line)) * 3
        output += '  |' + line.translate(trstring) + '|\n'
    output += '='*rowlen + '\n' + ' '*9
    output += ' '.join('{:02x}'.format(i) for i in range(hexlen))
    return output


def main():
    if len(argv) == 1:
        print("reading stdin")
        print(hexcat(stdin.read()))
    else:
        for arg in argv[1:]:
            with open(arg) as file:
                data = file.read()
            print(hexcat(data))

if __name__ == '__main__':
    main()
